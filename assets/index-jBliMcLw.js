const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-vendor-BCkPCHIy.js","assets/vendor-BkRrjKjn.js","assets/youtube-sdk-B3bbzXLp.js"])))=>i.map(i=>d[i]);
import{j as e,L as I,P as ie,B as de,S as ue,A as me,a as u,u as K,R as W,b as he,c as b,M as Y,I as J,F as Q,d as pe,O as xe,C as fe,e as L,T as ge,V as ye,f as F,h as Z,i as G,k as j,l as je,m as we,n as be,o as Ne,p as ve,q as ke,s as Pe,t as Ie,Q as Se,v as Ce,w as $e}from"./react-vendor-BCkPCHIy.js";import{I as k,J as Re,K as Ee,L as _e}from"./vendor-BkRrjKjn.js";import{c as X,a as Ae}from"./redux-CaHsegvC.js";import"./youtube-sdk-B3bbzXLp.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();const Te=()=>e.jsxs("nav",{className:"flex flex-row justify-between text-white bg-black w-full fixed bottom-0 z-10 border-t border-gray-300",children:[e.jsx(I,{to:"/",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(ie,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Главная"})]})}),e.jsx(I,{to:"/search",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(de,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Поиск"})]})}),e.jsx(I,{to:"/playlist",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(ue,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Моя медиатека"})]})}),e.jsx(I,{to:"/download",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(me,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Скачать приложение"})]})})]}),Le="modulepreload",Fe=function(t){return"/spotify-clone/"+t},B={},Me=function(s,r,o){let n=Promise.resolve();if(r&&r.length>0){let c=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),i=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=c(r.map(d=>{if(d=Fe(d),d in B)return;B[d]=!0;const m=d.endsWith(".css"),h=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":Le,m||(p.as="script"),p.crossOrigin="",p.href=d,i&&p.setAttribute("nonce",i),document.head.appendChild(p),m)return new Promise((x,y)=>{p.addEventListener("load",x),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return n.then(c=>{for(const a of c||[])a.status==="rejected"&&l(a.reason);return s().catch(l)})},qe=async t=>{const o=(await k.get("https://www.googleapis.com/youtube/v3/search",{params:{part:"snippet",maxResults:5,q:t,key:"AIzaSyCTqumDU6NwRkofVWL4C-WcOPL6tgz5Wvk",type:"video",videoEmbeddable:"true",videoSyndicated:"true"}})).data.items;for(let n of o)if(n.id&&n.id.videoId)return n.id.videoId;return null},Ue={isPlaying:!1,isPlayerVisible:!1},ee=X({name:"player",initialState:Ue,reducers:{togglePlay(t){t.isPlaying=!t.isPlaying},setIsPlaying(t,s){t.isPlaying=s.payload},setPlayerVisibility(t,s){t.isPlayerVisible=s.payload}}}),{togglePlay:De,setIsPlaying:H,setPlayerVisibility:ns}=ee.actions,Oe=ee.reducer,te=u.createContext({player:null,isPlaying:!1,duration:0,elapsed:0,setPlayer:t=>{},togglePlay:()=>{},setDuration:t=>{},setElapsed:t=>{}}),Be=({children:t})=>{const[s,r]=u.useState(null),[o,n]=u.useState(!1),[l,c]=u.useState(0),[a,i]=u.useState(0),d=u.useCallback(()=>{s&&(o?s.pauseVideo():s.playVideo(),n(m=>!m))},[s,o]);return e.jsx(te.Provider,{value:{player:s,isPlaying:o,duration:l,elapsed:a,setPlayer:r,togglePlay:d,setDuration:c,setElapsed:i},children:t})},M=()=>u.useContext(te),He=(t,s,r)=>{const o=K(),n=u.useRef(null),l=u.useRef(null),{setPlayer:c,setDuration:a,setElapsed:i}=M(),[d,m]=u.useState(0),h=x=>{const y=x.target;n.current=y,c(y),m(y.getDuration()),a(y.getDuration()),o(H(!1))};return u.useEffect(()=>(clearInterval(l.current),t&&n.current?(l.current=setInterval(()=>{r(x=>x>=d?(clearInterval(l.current),o(H(!1)),0):x+1)},1e3),n.current.playVideo()):!t&&n.current&&n.current.pauseVideo(),()=>clearInterval(l.current)),[t,d,o,r]),{playerRef:n,onReady:h,togglePlayHandler:()=>{const x=n.current;x&&(t?x.pauseVideo():x.playVideo(),o(De()))},playerDuration:d}},Ve=W.lazy(()=>Me(()=>import("./react-vendor-BCkPCHIy.js").then(t=>t.Y),__vite__mapDeps([0,1,2]))),ze=()=>{var f,g,N,v,P;const t=he(E=>E.track.selectedTrack),{player:s,isPlaying:r,togglePlay:o,duration:n,elapsed:l,setElapsed:c,setDuration:a}=M(),[i,d]=u.useState(0),{onReady:m,playerDuration:h}=He(r,n,c),p=(t==null?void 0:t.name)||"",x=((g=(f=t==null?void 0:t.artists)==null?void 0:f[0])==null?void 0:g.name)||"",y=((P=(v=(N=t==null?void 0:t.album)==null?void 0:N.images)==null?void 0:v[0])==null?void 0:P.url)||"";u.useEffect(()=>{console.log("Track name or artist name changed:",p,x)},[p,x]),u.useEffect(()=>{s&&l>=0&&d(l/n*100)},[l,s,n]),u.useEffect(()=>{h!==n&&a(h)},[h,n,a]);const{data:S,isLoading:$,isError:R}=b({queryKey:["youtubeSearch",p,x],queryFn:()=>qe(`${p} ${x}`),enabled:!!(t!=null&&t.id)&&!!p&&!!x,staleTime:1e3*60*5});return!(t!=null&&t.id)||!r?null:e.jsxs("div",{className:"fixed bottom-20 bg-cyan-950/60 left-1 right-1 p-2 rounded-md",children:[e.jsxs("div",{className:"flex flex-row max-h-10 justify-between items-center gap-4",children:[e.jsx("img",{src:y,alt:x,className:"object-contain flex-shrink-0 w-10 h-10 rounded-md"}),e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("h1",{className:"text-xl",children:x}),e.jsx("p",{className:"text-xs",children:p})]}),e.jsx(Y,{className:"text-3xl mr-3 object-contain flex-shrink-0 fill-white/50"}),e.jsx("button",{className:"text-2xl mr-3 object-contain flex-shrink-0",onClick:o,children:r?e.jsx(J,{}):e.jsx(Q,{})})]}),e.jsx("div",{className:"h-1 w-full bg-white/30 mt-2 relative rounded",children:e.jsx("span",{className:"h-1 bg-white/80 absolute rounded",style:{width:`${i}%`}})}),$&&console.log("Загрузка"),R&&console.log("Ошибка"),S&&e.jsx(Suspense,{fallback:e.jsx("div",{children:"Загрузка плеера..."}),children:e.jsx(Ve,{videoId:S,opts:{height:"0",width:"0",playerVars:{controls:0,modestbranding:1,rel:0}},onReady:m})})]})};function Ke({children:t}){return e.jsxs(e.Fragment,{children:[e.jsx("main",{className:"mb-30",children:t}),e.jsx(ze,{}),e.jsx(Te,{})]})}const w=pe({component:()=>e.jsx(Ke,{children:e.jsx(xe,{})})});function We({query:t,setQuery:s,setFocused:r,focused:o}){return e.jsxs("div",{className:"flex w-full items-center gap-3 h-10 p-3 pl-4 justify-between bg-white text-md rounded",children:[e.jsx(fe,{className:`fill-black  ${o?"w-6 h-6":"w-8 h-8"}`}),e.jsx("input",{type:"text",className:`w-full rounded border-0 not-[]:focus:outline-none \r
            focus:ring-0 focus:border-transparent focus:text-bold focus-visible:outline-none caret-cyan-950\r
             text-cyan-950 placeholder-gray-500 font-semibold placeholder:font-normal`,placeholder:"Что хочешь послушать?",value:t,onChange:n=>s(n.target.value),onFocus:()=>r(!0)}),t&&e.jsx(L,{onClick:()=>s(""),className:"fill-black w-7 h-7 cursor-pointer"})]})}const se=W.memo(function({data:s,onSelect:r,histored:o,onRemove:n,query:l}){return e.jsx("ul",{className:"space-y-2 mt-5",children:s==null?void 0:s.map(c=>{var a,i,d,m;return e.jsx(I,{to:`/artist/${c.id}`,state:{name:c.name,image:((i=(a=c.images)==null?void 0:a[0])==null?void 0:i.url)??null,followers:c.followers,searchQuery:l},className:"flex flex-col gap-2",children:e.jsxs("li",{className:"p-2 rounded shadow flex items-center gap-4 cursor-pointer",onClick:()=>{r(c)},children:[c.images&&c.images.length>0?e.jsx("img",{src:(m=(d=c.images)==null?void 0:d[0])==null?void 0:m.url,alt:c.name,width:"70",height:"70",className:"w-[70px] h-[70px] rounded-full mt-2 object-cover shrink-0"}):e.jsx("span",{className:"w-15 h-15 rounded-full mt-2 bg-gray-700",children:e.jsx(ge,{className:"flex items-center justify-center text-6xl text-purple-600"})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-bold",children:c.name}),e.jsx(ye,{className:"fill-blue-400 w-5 h-5 shrink-0"})]}),e.jsx("p",{className:"font-bold text-xs text-gray-500",children:c.type.charAt(0).toUpperCase()+c.type.slice(1).toLowerCase()})]}),o&&e.jsx("button",{onClick:h=>{h.stopPropagation(),h.preventDefault(),n==null||n(c.id)},children:e.jsx(L,{width:"28",height:"28",className:`w-[28px] h-[28px] object-cover shrink-0 cursor-pointer \r
                    hover:scale-110 transition-transform duration-200`})})]})]})},c.id)})})});function Ye({historySearch:t,onSelect:s,onRemove:r,onClear:o}){return t.length===0?e.jsxs("div",{className:"flex flex-col mt-10 gap-5",children:[e.jsx("h2",{className:"font-bold text-xl",children:"Слушай то, что нравится"}),e.jsx("h3",{className:"text-sm",children:"Находи исполнителей, треки, подкасты и не только."})]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{data:t,histored:!0,onSelect:s,onRemove:r}),e.jsx("button",{className:"flex px-5 py-2 text-white rounded-xl font-semibold mx-auto mt-4 border-white border-1 cursor-pointer hover:bg-gray-700 transition-colors duration-300",onClick:o,children:"Очистить историю"})]})}const Je=async()=>{var r;const t="d44bab85ff344e52908e5f90ec669cbc",s="74f2f6fbb0e4443da5af72448650465c";try{return(await k.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"client_credentials"}),{headers:{Authorization:`Basic ${btoa(`${t}:${s}`)}`,"Content-Type":"application/x-www-form-urlencoded"}})).data.access_token}catch(o){throw console.error("Error fetching Access Token:",((r=o.response)==null?void 0:r.data)||o.message),o}},Qe=()=>{const t="https://accounts.spotify.com/authorize",s="d44bab85ff344e52908e5f90ec669cbc",r=encodeURIComponent("http://127.0.0.1:5173/callback"),o="code",n=["user-read-private","user-read-email","user-top-read","user-library-read","playlist-modify-public","playlist-modify-private","user-read-playback-state","user-modify-playback-state","user-follow-read","user-read-recently-played","streaming","app-remote-control","ugc-image-upload","user-read-currently-playing","playlist-read-collaborative","playlist-read-private"].join(" ");return`${t}?client_id=${s}&response_type=${o}&redirect_uri=${r}&scope=${encodeURIComponent(n)}`},_=async(t,s={})=>{var r;try{const o=await Je();return(await k({url:`https://api.spotify.com/v1${t}`,headers:{Authorization:`Bearer ${o}`,...s.headers},...s})).data}catch(o){throw console.error(`Error making Spotify API request to ${t}:`,((r=o.response)==null?void 0:r.data)||o.message),o}},Ze=async t=>{if(!(t!=null&&t.trim()))return[];try{return(await _("/search",{params:{q:t,type:"artist",limit:20}})).artists.items}catch(s){throw console.error("Error searching artists:",s),s}},re=async t=>{try{return(await _(`/artists/${t}/top-tracks`,{params:{market:"US"}})).tracks}catch(s){throw console.error("Error getting artist top tracks:",s),s}},q=async t=>{try{return(await _(`/artists/${t}/albums`,{params:{market:"US",limit:10}})).items}catch(s){throw console.error("Error getting artist albums:",s),s}},Ge=async()=>{try{return(await _("/browse/categories",{params:{limit:50}})).categories.items}catch(t){console.log(t)}};function Xe(){const[t,s]=u.useState(""),[r,o]=u.useState(!1),[n,l]=u.useState(""),[c,a]=u.useState([]),[i]=Re(t,500),d=F(),{data:m,isLoading:h,isError:p,error:x}=b({queryKey:["tracks",i],queryFn:()=>Ze(i),enabled:!!(i!=null&&i.trim()),retry:1});u.useEffect(()=>{var g;const f=((g=d.state)==null?void 0:g.searchQuery)||"";f&&(s(f),o(!0))},[d.state]),u.useEffect(()=>{const f=JSON.parse(localStorage.getItem("historySearch")||"[]");a(f)},[]);const y=f=>{a(g=>{if(g.some(P=>P.id===f.id))return g;const v=[f,...g];return localStorage.setItem("historySearch",JSON.stringify(v)),v})};return{query:t,setQuery:s,focused:r,setFocused:o,navBack:()=>{t!==""?(s(""),o(!0)):o(!1)},data:m,isLoading:h,isError:p,error:x,historySearch:c,addToHistory:y,removeFromHistory:f=>{const g=c.filter(N=>N.id!==f);a(g),localStorage.setItem("historySearch",JSON.stringify(g))},clearHistory:()=>{localStorage.clear(),a([])},onSelectArtist:f=>{l(f.id),q(f.id),y(f)}}}function et(){const{data:t,isLoading:s,isError:r}=b({queryKey:["categories"],queryFn:()=>Ge()});r&&console.log("Error, cant load categories"),console.log(t);const o=()=>{let n="#";for(let l=0;l<6;l++)n+=(Math.random()*9).toFixed(0);return n};return e.jsxs("div",{children:[e.jsx("h2",{className:"pb-5 text-white text-lg font-bold mt-4",children:"Все остальное"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:t==null?void 0:t.map((n,l)=>{var a,i;const c=o();return e.jsxs("div",{className:"h-24 p-2 font-bold rounded relative overflow-hidden",style:{backgroundColor:c},children:[n.name,e.jsx("img",{className:"w-17 h-17 absolute right-0 inset-x-37 bottom-0 rotate-25",src:(i=(a=n.icons)==null?void 0:a[0])==null?void 0:i.url,alt:n.name})]},l)})})]})}function ae(){const{history:t}=Z();return e.jsx(G,{className:"w-8 h-8 cursor-pointer",onClick:()=>t.go(-1)})}function tt(){const{query:t,setQuery:s,focused:r,setFocused:o,navBack:n,data:l,isLoading:c,isError:a,error:i,historySearch:d,removeFromHistory:m,clearHistory:h,onSelectArtist:p}=Xe();return e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"flex flex-col p-4",children:[!r&&e.jsx("h1",{className:"pb-5 text-white text-3xl",children:"Искать"}),e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[r&&e.jsx(ae,{onClick:n}),e.jsx(We,{query:t,setQuery:s,setFocused:o,focused:r})]})]}),r&&t===""?e.jsx(Ye,{historySearch:d,onSelect:p,onRemove:m,onClear:h}):r?t!==""&&e.jsx(se,{data:l,query:t,onSelect:p}):e.jsx(et,{}),c&&e.jsx("p",{className:"mt-10 flex items-center justify-center",children:"Загрузка..."}),a&&e.jsxs("p",{className:"text-red-500",children:["Ошибка: ",(i==null?void 0:i.message)||"Неизвестная ошибка"]})]})}const st=j("/search")({component:rt});function rt(){return e.jsx("div",{className:"p-2",children:e.jsx(tt,{})})}const at=async()=>{const t=localStorage.getItem("access_token"),s=localStorage.getItem("refresh_token");if(!t&&!s)throw new Error("Нет токенов доступа");try{return await k.get("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${t}`}}),t}catch{const n=(await k.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"refresh_token",refresh_token:s}),{headers:{Authorization:`Basic ${btoa("d44bab85ff344e52908e5f90ec669cbc:74f2f6fbb0e4443da5af72448650465c")}`,"Content-Type":"application/x-www-form-urlencoded"}})).data.access_token;return localStorage.setItem("access_token",n),n}},U=async(t,s={})=>{var r;try{const o=await at();if(!o)throw new Error("Нет действующего токена доступа");return(await k({url:`https://api.spotify.com/v1${t}`,headers:{Authorization:`Bearer ${o}`,...s.headers},...s})).data}catch(o){throw console.error(`Ошибка при запросе к Spotify API: ${t}`,((r=o.response)==null?void 0:r.data)||o.message),o}},nt=async()=>{const t=localStorage.getItem("access_token");if(!t){console.log("Токен не найден");return}try{return(await k.get("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${t}`}})).data}catch(s){throw console.error("Error getting user:",s),s}},ot=async t=>{if(!localStorage.getItem("access_token"))return[];try{return(await U(`/me/top/${t}`,{params:{limit:10,time_range:"medium_term"}})).items}catch(r){return console.log(r),[]}},ct=async()=>{if(!localStorage.getItem("access_token"))return console.error("Ошибка: Нет access_token"),[];try{return(await U("/me/player/recently-played",{params:{limit:10}})).items||[]}catch(s){return console.error("Ошибка при получении недавно прослушанных треков:",s),[]}},lt=async()=>{if(!localStorage.getItem("access_token"))return console.error("Ошибка: Нет access_token"),[];try{return(await U("/me/playlists",{params:{limit:10}})).items}catch(s){console.log(s)}};function it(){const{data:t,isLoading:s,isError:r}=b({queryKey:["playlists"],queryFn:()=>lt()});return r&&console.log("Error on userPlaylist"),console.log(t),e.jsxs("div",{className:"gap-4 flex flex-col p-4",children:[e.jsx("h3",{className:"text-2xl pb-5",children:"Моя медиатека"}),t==null?void 0:t.map(o=>{var n,l;return e.jsxs("div",{className:"flex flex-row gap-4 items-center cursor-pointer",children:[e.jsx("img",{className:"w-20 h-20",src:(l=(n=o.images)==null?void 0:n[0])==null?void 0:l.url,alt:o.name}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{children:o.name}),e.jsx("span",{children:`${o.type} • ${o.owner.display_name}`})]})]},o.name)})]})}const dt=j("/playlist")({component:ut});function ut(){return e.jsx("div",{className:"p-2",children:e.jsx(it,{})})}const mt=j("/download")({component:ht});function ht(){return e.jsx("div",{className:"p-2",children:e.jsx("h3",{children:"Скачать приложение"})})}const pt=j("/callback")({component:xt});function xt(){return u.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("code");if(!t)return;(async()=>{var r;try{const o=await k.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:"http://127.0.0.1:5173/callback"}),{headers:{Authorization:"Basic "+btoa("d44bab85ff344e52908e5f90ec669cbc:74f2f6fbb0e4443da5af72448650465c"),"Content-Type":"application/x-www-form-urlencoded"}}),{access_token:n,refresh_token:l}=o.data;localStorage.setItem("access_token",n),localStorage.setItem("refresh_token",l),setTimeout(()=>{window.location.href="/"},1e3)}catch(o){console.error("Ошибка авторизации Spotify:",((r=o.response)==null?void 0:r.data)||o)}})()},[]),e.jsx("div",{className:"text-center min-h-screen",children:e.jsxs("div",{role:"status",className:"text-center min-h-screen flex items-center justify-center",children:[e.jsxs("svg",{"aria-hidden":"true",className:"inline w-17 h-17 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),e.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),e.jsx("span",{className:"sr-only",children:"Loading..."})]})})}function ft({onToggleMenu:t}){const[s,r]=u.useState();return u.useEffect(()=>{(async()=>{try{const n=await nt();r(n)}catch(n){console.log("Немогу получить данные",n)}})()},[]),e.jsxs("header",{className:"flex items-center justify-between text-white p-4 mb-5",children:[e.jsxs("div",{className:"flex gap-4 items-center text-xl font-bold",children:[e.jsxs("h1",{children:["Добро пожаловать, ",(s==null?void 0:s.display_name)||"Гость"]}),(s==null?void 0:s.country)&&e.jsx(je,{code:s.country,style:{width:30,height:20}})]}),e.jsx(we,{className:"hover:scale-110 transition-transform h-7 w-7 cursor-pointer",onClick:t})]})}const C={logMenu:["Войти","Зарегистрироваться"],mainMenu:["Акаунт","Профиль","Выйти","Premium"],secondaryMenu:["Справка","Скачать","Конфиденциальность","Условия"]};function gt({onCloseMenu:t}){const[s,r]=u.useState(C.logMenu),{secondaryMenu:o}=C;u.useEffect(()=>{const c=localStorage.getItem("access_token");r(c?C.mainMenu:C.logMenu)},[]);const n=()=>{localStorage.removeItem("access_token"),r(C.logMenu)},l=()=>{window.location.href=Qe(),r(C.mainMenu)};return e.jsxs("menu",{className:"mx-auto w-full h-full min-h-screen flex flex-col text-white font-bold gap-6 absolute top-0 left-0 bg-black px-10 py-13",children:[e.jsx(L,{className:"absolute right-4 top-4 text-4xl hover:scale-110 transition-transform h-7 w-7 cursor-pointer",onClick:t}),e.jsx("ul",{className:"flex flex-col gap-6",children:s.map((c,a)=>e.jsx("li",{onClick:c==="Войти"?l:c==="Выйти"?n:void 0,className:"text-2xl hover:scale-110 transition-transform duration-200 cursor-pointer",children:c},a))}),e.jsx("hr",{className:"w-5 my-5 border-1"}),e.jsx("ul",{className:"flex space-x-4 flex-col gap-6",children:o.map((c,a)=>e.jsx("li",{className:"hover:scale-110 transition-transform duration-200 cursor-pointer",children:c},a))})]})}const ne=X({name:"track",initialState:{selectedTrack:null},reducers:{setTrack:(t,s)=>{t.selectedTrack=s.payload}}}),{setTrack:yt}=ne.actions,jt=ne.reducer;function A({header:t,item:s,hideItem:r}){const o=K(),n=a=>{const i=album.track||album;o(yt(i))},l=a=>{var d,m,h,p,x;const i=(a==null?void 0:a.track)||a;return((h=(m=(d=i==null?void 0:i.album)==null?void 0:d.images)==null?void 0:m[0])==null?void 0:h.url)||((x=(p=i==null?void 0:i.images)==null?void 0:p[0])==null?void 0:x.url)||null},c=a=>{var i,d;return a!=null&&a.type&&(a!=null&&a.id)?`/${a.type}/${a.id}`:`/${(i=a==null?void 0:a.track)==null?void 0:i.type}/${(d=a==null?void 0:a.track)==null?void 0:d.id}`};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-xl font-bold items-start pl-4 mb-5",children:t}),e.jsx("div",{className:`flex flex-row items-baseline justify-baseline \r
          overflow-x-auto snap-x snap-mandatory scroll-smooth gap-4 px-4 `,children:s==null?void 0:s.map(a=>{var i,d,m,h;return e.jsx(I,{to:c(a),state:{name:a.name,image:((d=(i=a.images)==null?void 0:i[0])==null?void 0:d.url)??null,followers:a.followers,obj:a.track||a},children:e.jsxs("div",{onClick:()=>n(),className:`flex flex-col items-start justify-baseline flex-shrink-0\r
                  snap-center mb-10 h-auto cursor-pointer`,children:[e.jsx("img",{src:l(a),alt:a.name,className:"object-cover flex-shrink-0 rounded-lg max-w-[170px] max-h-[170px]"}),e.jsxs("div",{className:"flex flex-col items-start justify-center mt-3",children:[e.jsx("h2",{className:"text-sm/tight font-bold max-w-[170px]",children:a.name||a.track.name}),e.jsx("p",{children:r?"":`${a==null?void 0:a.type} • ${(m=a==null?void 0:a.release_date)==null?void 0:m.slice(0,4)}`})]})]})},(a==null?void 0:a.id)||((h=a==null?void 0:a.track)==null?void 0:h.id))})})]})}const D=t=>b({queryKey:["topItems",t],queryFn:t==="recently"?ct:()=>ot(t)});function wt(){const{data:t,isLoading:s,isError:r}=D("artists");return e.jsx(e.Fragment,{children:e.jsx(A,{header:"Любимые исполнители",item:t,hideItem:!0})})}function bt(){const{data:t,isLoading:s,isError:r}=D("tracks");return e.jsx(A,{header:"Любимые треки",item:t,hideItem:!0})}function Nt(){const{data:t,isLoading:s,isError:r}=D("recently");return e.jsx(A,{header:"Недавно слушал",item:t,hideItem:!0})}function vt(){const t=localStorage.getItem("access_token");return e.jsx(e.Fragment,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(wt,{}),e.jsx(bt,{}),e.jsx(Nt,{})]}):e.jsx("h1",{className:"pl-4",children:"Пожалуйста войдите в свой акаунт"})})}const kt=j("/")({component:Pt});function Pt(){const[t,s]=u.useState(!1),r=()=>{s(o=>!o)};return e.jsxs(e.Fragment,{children:[e.jsx(ft,{onToggleMenu:r}),t&&e.jsx(gt,{onCloseMenu:r}),e.jsx(vt,{})]})}function oe({tracks:t,artist:s}){return e.jsxs("div",{className:"mt-10",children:[e.jsxs("h1",{className:"p-4 text-xl",children:["Популярные треки ",s]}),t==null?void 0:t.map(r=>{var o,n,l,c;return e.jsx(I,{to:`/${r.type}/${r.id}`,state:{name:r.name,image:((n=(o=r.images)==null?void 0:o[0])==null?void 0:n.url)??null,followers:r.followers,obj:r},children:e.jsxs("div",{style:r.is_playable?{}:{opacity:.2},className:"flex items-center gap-4 p-4",onClick:()=>console.log(r),children:[e.jsx("img",{width:"80",height:"80",className:"w-[80px] h-[80px]",src:(c=(l=r.album.images)==null?void 0:l[0])==null?void 0:c.url,alt:r.name}),e.jsxs("div",{className:"flex flex-col items-start justify-center mt-3",children:[e.jsx("h1",{children:r.name}),e.jsxs("p",{className:"flex items-center gap-2",children:[Math.floor(r.duration_ms/1e3/60),".",Math.floor(r.duration_ms/1e3%60).toString().padStart(2,"0")," ","min",r.explicit&&e.jsx(be,{}),r.popularity>85&&e.jsx(Ne,{className:"fill-amber-700"})]}),!r.is_playable&&e.jsxs("span",{className:"text-gray-500 text-xs flex items-center gap-2",children:[e.jsx(ve,{})," Недоступно в вашем регионе"]})]})]})},r.id||r.track.id)})]})}function ce({albums:t}){return e.jsx(e.Fragment,{children:e.jsx(A,{header:"Альбомы",item:t,hideItem:!1})})}function It(){const{player:t,isPlaying:s,togglePlay:r,duration:o,elapsed:n}=M(),[l,c]=u.useState(0);return u.useEffect(()=>{t&&n>=0&&c(n/o*100)},[n,t,o]),e.jsxs("div",{className:"flex justify-between items-center mt-4 pb-3",children:[e.jsx(Y,{className:"text-3xl mr-3 object-contain flex-shrink-0 fill-white/50"}),e.jsx("button",{onClick:r,className:"text-2xl mr-3 object-contain flex-shrink-0 bg-green-600 rounded-full w-15 h-15 flex items-center justify-center",children:s?e.jsx(J,{className:"fill-black w-5 h-5"}):e.jsx(Q,{className:"fill-black w-5 h-5"})})]})}function St(){var d,m,h,p,x,y,S,$,R,f,g,N,v,P,E;const t=F(),{obj:s}=t.state,r=(m=(d=s==null?void 0:s.artists)==null?void 0:d[0])==null?void 0:m.id;(h=s==null?void 0:s.album)==null||h.id,console.log(s);const{data:o,isLoading:n,isError:l}=b({queryKey:["tracks",r],queryFn:()=>re(r)}),{data:c,isLoading:a,isError:i}=b({queryKey:["albums",r],queryFn:()=>q(r)});return(l||i)&&console.log("Error with loading artist top tracks"),e.jsxs("div",{children:[e.jsxs("div",{className:" bg-gradient-to-b from-orange-500 to-black-900 p-4",children:[e.jsx(ae,{}),e.jsx("div",{className:"flex flex-col items-center justify-center",children:e.jsx("img",{width:"200",height:"200",className:" w-[200px] h-[200px] object-cover flex items-center justify-center shrink-0",src:((y=(x=(p=s.track)==null?void 0:p.album.images)==null?void 0:x[0])==null?void 0:y.url)||(($=(S=s==null?void 0:s.album.images)==null?void 0:S[0])==null?void 0:$.url),alt:""})}),e.jsxs("div",{className:"flex flex-col pt-4 gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold items-start",children:s.name}),e.jsx("div",{className:"flex gap-3",children:(R=s==null?void 0:s.artists)==null?void 0:R.map(O=>e.jsx("span",{children:O.name},O.name))}),e.jsxs("div",{className:"flex gap-2 text-white/60",children:[e.jsx("span",{children:(f=s==null?void 0:s.album)==null?void 0:f.release_date.slice(0,4)})," •",e.jsx("span",{children:((g=s==null?void 0:s.album)==null?void 0:g.total_tracks)===1?`${(N=s==null?void 0:s.album)==null?void 0:N.total_tracks} трек`:`${(v=s==null?void 0:s.album)==null?void 0:v.total_tracks} треков`})," ","•",e.jsxs("span",{children:[Math.floor(s.duration_ms/1e3/60),":",Math.floor(s.duration_ms/1e3%60).toString().padStart(2,"0")," "]})]})]}),e.jsx(It,{})]}),e.jsx(oe,{artist:(E=(P=s==null?void 0:s.artists)==null?void 0:P[0])==null?void 0:E.name,tracks:o}),e.jsx(ce,{albums:c})]})}const Ct=j("/track/$trackId")({component:$t});function $t(){return e.jsx("div",{children:e.jsx(St,{})})}const Rt=j("/playlist/playlistId")({component:Et});function Et(){return e.jsx("div",{children:'Hello "/playlist/playlistId"!'})}const _t=j("/artist/$id")({component:At});function At(){return e.jsx("div",{children:'Hello "/artist/$id"!'})}function Tt({artistInfo:t}){var a;const{name:s,image:r,followers:o,searchQuery:n}=t||{},l=Z(),c=()=>{l.navigate({to:"/search",replace:!0,state:{searchQuery:n}})};return e.jsxs("div",{className:"m-4",children:[e.jsx(G,{className:"m-4 w-8 h-8 cursor-pointer",onClick:c}),e.jsx("div",{className:"flex flex-col items-center justify-center",children:e.jsx("img",{width:"200",height:"200",className:"rounded-full w-[200px] h-[200px] object-cover flex items-center justify-center shrink-0",src:r,alt:""})}),e.jsxs("div",{className:"flex flex-col items-center justify-center pt-4",children:[e.jsx("h1",{className:"text-2xl font-bold items-start",children:((a=s==null?void 0:s.charAt(0))==null?void 0:a.toUpperCase())+(s==null?void 0:s.slice(1))}),e.jsxs("p",{children:[" ",new Intl.NumberFormat().format(o==null?void 0:o.total)," - фоловеров"]})]})]})}function Lt(){const t=F(),s=ke({from:"/artist/$artistId",select:i=>i.artistId}),{data:r,isLoading:o,error:n}=b({queryKey:["artist",s],queryFn:()=>q(s)}),{data:l,isLoading:c,error:a}=b({queryKey:["tracks",s],queryFn:()=>re(s)});return o||c?e.jsx("div",{className:"mx-auto my-auto flex justify-center items-center",children:"Loading..."}):n||a?(console.log("artistId passed to useQuery:",s),e.jsxs("div",{children:["Error: ",(n==null?void 0:n.message)||(a==null?void 0:a.message)]})):e.jsxs("div",{children:[e.jsx(Tt,{artistInfo:t.state}),e.jsx(oe,{tracks:l}),e.jsx(ce,{albums:r})]})}const Ft=j("/artist/$artistId")({component:Lt}),Mt=j("/album/$albumId")({component:qt});function qt(){return e.jsx("div",{children:'Hello "/album/$albumId"!'})}const Ut=st.update({id:"/search",path:"/search",getParentRoute:()=>w}),le=dt.update({id:"/playlist",path:"/playlist",getParentRoute:()=>w}),Dt=mt.update({id:"/download",path:"/download",getParentRoute:()=>w}),Ot=pt.update({id:"/callback",path:"/callback",getParentRoute:()=>w}),Bt=kt.update({id:"/",path:"/",getParentRoute:()=>w}),Ht=Ct.update({id:"/track/$trackId",path:"/track/$trackId",getParentRoute:()=>w}),Vt=Rt.update({id:"/playlistId",path:"/playlistId",getParentRoute:()=>le}),zt=_t.update({id:"/artist/$id",path:"/artist/$id",getParentRoute:()=>w}),Kt=Ft.update({id:"/artist/$artistId",path:"/artist/$artistId",getParentRoute:()=>w}),Wt=Mt.update({id:"/album/$albumId",path:"/album/$albumId",getParentRoute:()=>w}),Yt={PlaylistPlaylistIdRoute:Vt},Jt=le._addFileChildren(Yt),Qt={IndexRoute:Bt,CallbackRoute:Ot,DownloadRoute:Dt,PlaylistRoute:Jt,SearchRoute:Ut,AlbumAlbumIdRoute:Wt,ArtistArtistIdRoute:Kt,ArtistIdRoute:zt,TrackTrackIdRoute:Ht},Zt=w._addFileChildren(Qt)._addFileTypes(),Gt=Ae({reducer:{player:Oe,track:jt}}),V="/spotify-clone",T=Ee(),Xt=Pe({routeTree:Zt,history:{...T,push:t=>T.push(`${V}${t}`),replace:t=>T.replace(`${V}${t}`)}}),es=new _e({defaultOptions:{queries:{staleTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}}}),z=document.getElementById("root");z.innerHTML||Ie.createRoot(z).render(e.jsx(Se,{client:es,children:e.jsx(Ce,{store:Gt,children:e.jsx(Be,{children:e.jsx($e,{router:Xt})})})}));
