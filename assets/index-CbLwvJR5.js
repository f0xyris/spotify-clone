const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-vendor-Dk1cENmL.js","assets/vendor-NUSWEvYs.js","assets/youtube-sdk-BO56xrsD.js"])))=>i.map(i=>d[i]);
import{j as e,L as I,P as ce,B as le,S as ie,A as de,a as u,u as V,R as z,b as ue,c as b,M as K,I as W,F as Y,d as me,O as he,C as pe,e as T,T as xe,V as fe,f as L,h as J,i as Q,k as j,l as ge,m as ye,n as je,o as we,p as be,q as Ne,s as ve,t as ke,Q as Pe,v as Ie,w as Se}from"./react-vendor-Dk1cENmL.js";import{I as k,J as Ce,K as Re}from"./vendor-NUSWEvYs.js";import{c as Z,a as $e}from"./redux-CxAhX_1D.js";import"./youtube-sdk-BO56xrsD.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();const Ee=()=>e.jsxs("nav",{className:"flex flex-row justify-between text-white bg-black w-full fixed bottom-0 z-10 border-t border-gray-300",children:[e.jsx(I,{to:"/",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(ce,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Главная"})]})}),e.jsx(I,{to:"/search",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(le,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Поиск"})]})}),e.jsx(I,{to:"/playlist",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(ie,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Моя медиатека"})]})}),e.jsx(I,{to:"/download",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(de,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Скачать приложение"})]})})]}),_e="modulepreload",Ae=function(s){return"/spotify-clone/"+s},O={},Te=function(t,r,o){let n=Promise.resolve();if(r&&r.length>0){let c=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),i=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=c(r.map(d=>{if(d=Ae(d),d in O)return;O[d]=!0;const m=d.endsWith(".css"),h=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":_e,m||(p.as="script"),p.crossOrigin="",p.href=d,i&&p.setAttribute("nonce",i),document.head.appendChild(p),m)return new Promise((x,y)=>{p.addEventListener("load",x),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return n.then(c=>{for(const a of c||[])a.status==="rejected"&&l(a.reason);return t().catch(l)})},Le=async s=>{const o=(await k.get("https://www.googleapis.com/youtube/v3/search",{params:{part:"snippet",maxResults:5,q:s,key:"AIzaSyCTqumDU6NwRkofVWL4C-WcOPL6tgz5Wvk",type:"video",videoEmbeddable:"true",videoSyndicated:"true"}})).data.items;for(let n of o)if(n.id&&n.id.videoId)return n.id.videoId;return null},Fe={isPlaying:!1,isPlayerVisible:!1},G=Z({name:"player",initialState:Fe,reducers:{togglePlay(s){s.isPlaying=!s.isPlaying},setIsPlaying(s,t){s.isPlaying=t.payload},setPlayerVisibility(s,t){s.isPlayerVisible=t.payload}}}),{togglePlay:Me,setIsPlaying:B,setPlayerVisibility:ss}=G.actions,qe=G.reducer,X=u.createContext({player:null,isPlaying:!1,duration:0,elapsed:0,setPlayer:s=>{},togglePlay:()=>{},setDuration:s=>{},setElapsed:s=>{}}),Ue=({children:s})=>{const[t,r]=u.useState(null),[o,n]=u.useState(!1),[l,c]=u.useState(0),[a,i]=u.useState(0),d=u.useCallback(()=>{t&&(o?t.pauseVideo():t.playVideo(),n(m=>!m))},[t,o]);return e.jsx(X.Provider,{value:{player:t,isPlaying:o,duration:l,elapsed:a,setPlayer:r,togglePlay:d,setDuration:c,setElapsed:i},children:s})},F=()=>u.useContext(X),De=(s,t,r)=>{const o=V(),n=u.useRef(null),l=u.useRef(null),{setPlayer:c,setDuration:a,setElapsed:i}=F(),[d,m]=u.useState(0),h=x=>{const y=x.target;n.current=y,c(y),m(y.getDuration()),a(y.getDuration()),o(B(!1))};return u.useEffect(()=>(clearInterval(l.current),s&&n.current?(l.current=setInterval(()=>{r(x=>x>=d?(clearInterval(l.current),o(B(!1)),0):x+1)},1e3),n.current.playVideo()):!s&&n.current&&n.current.pauseVideo(),()=>clearInterval(l.current)),[s,d,o,r]),{playerRef:n,onReady:h,togglePlayHandler:()=>{const x=n.current;x&&(s?x.pauseVideo():x.playVideo(),o(Me()))},playerDuration:d}},Oe=z.lazy(()=>Te(()=>import("./react-vendor-Dk1cENmL.js").then(s=>s.Y),__vite__mapDeps([0,1,2]))),Be=()=>{var f,g,N,v,P;const s=ue(E=>E.track.selectedTrack),{player:t,isPlaying:r,togglePlay:o,duration:n,elapsed:l,setElapsed:c,setDuration:a}=F(),[i,d]=u.useState(0),{onReady:m,playerDuration:h}=De(r,n,c),p=(s==null?void 0:s.name)||"",x=((g=(f=s==null?void 0:s.artists)==null?void 0:f[0])==null?void 0:g.name)||"",y=((P=(v=(N=s==null?void 0:s.album)==null?void 0:N.images)==null?void 0:v[0])==null?void 0:P.url)||"";u.useEffect(()=>{console.log("Track name or artist name changed:",p,x)},[p,x]),u.useEffect(()=>{t&&l>=0&&d(l/n*100)},[l,t,n]),u.useEffect(()=>{h!==n&&a(h)},[h,n,a]);const{data:S,isLoading:R,isError:$}=b({queryKey:["youtubeSearch",p,x],queryFn:()=>Le(`${p} ${x}`),enabled:!!(s!=null&&s.id)&&!!p&&!!x,staleTime:1e3*60*5});return!(s!=null&&s.id)||!r?null:e.jsxs("div",{className:"fixed bottom-20 bg-cyan-950/60 left-1 right-1 p-2 rounded-md",children:[e.jsxs("div",{className:"flex flex-row max-h-10 justify-between items-center gap-4",children:[e.jsx("img",{src:y,alt:x,className:"object-contain flex-shrink-0 w-10 h-10 rounded-md"}),e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("h1",{className:"text-xl",children:x}),e.jsx("p",{className:"text-xs",children:p})]}),e.jsx(K,{className:"text-3xl mr-3 object-contain flex-shrink-0 fill-white/50"}),e.jsx("button",{className:"text-2xl mr-3 object-contain flex-shrink-0",onClick:o,children:r?e.jsx(W,{}):e.jsx(Y,{})})]}),e.jsx("div",{className:"h-1 w-full bg-white/30 mt-2 relative rounded",children:e.jsx("span",{className:"h-1 bg-white/80 absolute rounded",style:{width:`${i}%`}})}),R&&console.log("Загрузка"),$&&console.log("Ошибка"),S&&e.jsx(Suspense,{fallback:e.jsx("div",{children:"Загрузка плеера..."}),children:e.jsx(Oe,{videoId:S,opts:{height:"0",width:"0",playerVars:{controls:0,modestbranding:1,rel:0}},onReady:m})})]})};function He({children:s}){return e.jsxs(e.Fragment,{children:[e.jsx("main",{className:"mb-30",children:s}),e.jsx(Be,{}),e.jsx(Ee,{})]})}const w=me({component:()=>e.jsx(He,{children:e.jsx(he,{})})});function Ve({query:s,setQuery:t,setFocused:r,focused:o}){return e.jsxs("div",{className:"flex w-full items-center gap-3 h-10 p-3 pl-4 justify-between bg-white text-md rounded",children:[e.jsx(pe,{className:`fill-black  ${o?"w-6 h-6":"w-8 h-8"}`}),e.jsx("input",{type:"text",className:`w-full rounded border-0 not-[]:focus:outline-none \r
            focus:ring-0 focus:border-transparent focus:text-bold focus-visible:outline-none caret-cyan-950\r
             text-cyan-950 placeholder-gray-500 font-semibold placeholder:font-normal`,placeholder:"Что хочешь послушать?",value:s,onChange:n=>t(n.target.value),onFocus:()=>r(!0)}),s&&e.jsx(T,{onClick:()=>t(""),className:"fill-black w-7 h-7 cursor-pointer"})]})}const ee=z.memo(function({data:t,onSelect:r,histored:o,onRemove:n,query:l}){return e.jsx("ul",{className:"space-y-2 mt-5",children:t==null?void 0:t.map(c=>{var a,i,d,m;return e.jsx(I,{to:`/artist/${c.id}`,state:{name:c.name,image:((i=(a=c.images)==null?void 0:a[0])==null?void 0:i.url)??null,followers:c.followers,searchQuery:l},className:"flex flex-col gap-2",children:e.jsxs("li",{className:"p-2 rounded shadow flex items-center gap-4 cursor-pointer",onClick:()=>{r(c)},children:[c.images&&c.images.length>0?e.jsx("img",{src:(m=(d=c.images)==null?void 0:d[0])==null?void 0:m.url,alt:c.name,width:"70",height:"70",className:"w-[70px] h-[70px] rounded-full mt-2 object-cover shrink-0"}):e.jsx("span",{className:"w-15 h-15 rounded-full mt-2 bg-gray-700",children:e.jsx(xe,{className:"flex items-center justify-center text-6xl text-purple-600"})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-bold",children:c.name}),e.jsx(fe,{className:"fill-blue-400 w-5 h-5 shrink-0"})]}),e.jsx("p",{className:"font-bold text-xs text-gray-500",children:c.type.charAt(0).toUpperCase()+c.type.slice(1).toLowerCase()})]}),o&&e.jsx("button",{onClick:h=>{h.stopPropagation(),h.preventDefault(),n==null||n(c.id)},children:e.jsx(T,{width:"28",height:"28",className:`w-[28px] h-[28px] object-cover shrink-0 cursor-pointer \r
                    hover:scale-110 transition-transform duration-200`})})]})]})},c.id)})})});function ze({historySearch:s,onSelect:t,onRemove:r,onClear:o}){return s.length===0?e.jsxs("div",{className:"flex flex-col mt-10 gap-5",children:[e.jsx("h2",{className:"font-bold text-xl",children:"Слушай то, что нравится"}),e.jsx("h3",{className:"text-sm",children:"Находи исполнителей, треки, подкасты и не только."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{data:s,histored:!0,onSelect:t,onRemove:r}),e.jsx("button",{className:"flex px-5 py-2 text-white rounded-xl font-semibold mx-auto mt-4 border-white border-1 cursor-pointer hover:bg-gray-700 transition-colors duration-300",onClick:o,children:"Очистить историю"})]})}const Ke=async()=>{var r;const s="d44bab85ff344e52908e5f90ec669cbc",t="74f2f6fbb0e4443da5af72448650465c";try{return(await k.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"client_credentials"}),{headers:{Authorization:`Basic ${btoa(`${s}:${t}`)}`,"Content-Type":"application/x-www-form-urlencoded"}})).data.access_token}catch(o){throw console.error("Error fetching Access Token:",((r=o.response)==null?void 0:r.data)||o.message),o}},We=()=>{const s="https://accounts.spotify.com/authorize",t="d44bab85ff344e52908e5f90ec669cbc",r=encodeURIComponent("http://127.0.0.1:5173/callback"),o="code",n=["user-read-private","user-read-email","user-top-read","user-library-read","playlist-modify-public","playlist-modify-private","user-read-playback-state","user-modify-playback-state","user-follow-read","user-read-recently-played","streaming","app-remote-control","ugc-image-upload","user-read-currently-playing","playlist-read-collaborative","playlist-read-private"].join(" ");return`${s}?client_id=${t}&response_type=${o}&redirect_uri=${r}&scope=${encodeURIComponent(n)}`},_=async(s,t={})=>{var r;try{const o=await Ke();return(await k({url:`https://api.spotify.com/v1${s}`,headers:{Authorization:`Bearer ${o}`,...t.headers},...t})).data}catch(o){throw console.error(`Error making Spotify API request to ${s}:`,((r=o.response)==null?void 0:r.data)||o.message),o}},Ye=async s=>{if(!(s!=null&&s.trim()))return[];try{return(await _("/search",{params:{q:s,type:"artist",limit:20}})).artists.items}catch(t){throw console.error("Error searching artists:",t),t}},te=async s=>{try{return(await _(`/artists/${s}/top-tracks`,{params:{market:"US"}})).tracks}catch(t){throw console.error("Error getting artist top tracks:",t),t}},M=async s=>{try{return(await _(`/artists/${s}/albums`,{params:{market:"US",limit:10}})).items}catch(t){throw console.error("Error getting artist albums:",t),t}},Je=async()=>{try{return(await _("/browse/categories",{params:{limit:50}})).categories.items}catch(s){console.log(s)}};function Qe(){const[s,t]=u.useState(""),[r,o]=u.useState(!1),[n,l]=u.useState(""),[c,a]=u.useState([]),[i]=Ce(s,500),d=L(),{data:m,isLoading:h,isError:p,error:x}=b({queryKey:["tracks",i],queryFn:()=>Ye(i),enabled:!!(i!=null&&i.trim()),retry:1});u.useEffect(()=>{var g;const f=((g=d.state)==null?void 0:g.searchQuery)||"";f&&(t(f),o(!0))},[d.state]),u.useEffect(()=>{const f=JSON.parse(localStorage.getItem("historySearch")||"[]");a(f)},[]);const y=f=>{a(g=>{if(g.some(P=>P.id===f.id))return g;const v=[f,...g];return localStorage.setItem("historySearch",JSON.stringify(v)),v})};return{query:s,setQuery:t,focused:r,setFocused:o,navBack:()=>{s!==""?(t(""),o(!0)):o(!1)},data:m,isLoading:h,isError:p,error:x,historySearch:c,addToHistory:y,removeFromHistory:f=>{const g=c.filter(N=>N.id!==f);a(g),localStorage.setItem("historySearch",JSON.stringify(g))},clearHistory:()=>{localStorage.clear(),a([])},onSelectArtist:f=>{l(f.id),M(f.id),y(f)}}}function Ze(){const{data:s,isLoading:t,isError:r}=b({queryKey:["categories"],queryFn:()=>Je()});r&&console.log("Error, cant load categories"),console.log(s);const o=()=>{let n="#";for(let l=0;l<6;l++)n+=(Math.random()*9).toFixed(0);return n};return e.jsxs("div",{children:[e.jsx("h2",{className:"pb-5 text-white text-lg font-bold mt-4",children:"Все остальное"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:s==null?void 0:s.map((n,l)=>{var a,i;const c=o();return e.jsxs("div",{className:"h-24 p-2 font-bold rounded relative overflow-hidden",style:{backgroundColor:c},children:[n.name,e.jsx("img",{className:"w-17 h-17 absolute right-0 inset-x-37 bottom-0 rotate-25",src:(i=(a=n.icons)==null?void 0:a[0])==null?void 0:i.url,alt:n.name})]},l)})})]})}function se(){const{history:s}=J();return e.jsx(Q,{className:"w-8 h-8 cursor-pointer",onClick:()=>s.go(-1)})}function Ge(){const{query:s,setQuery:t,focused:r,setFocused:o,navBack:n,data:l,isLoading:c,isError:a,error:i,historySearch:d,removeFromHistory:m,clearHistory:h,onSelectArtist:p}=Qe();return e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"flex flex-col p-4",children:[!r&&e.jsx("h1",{className:"pb-5 text-white text-3xl",children:"Искать"}),e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[r&&e.jsx(se,{onClick:n}),e.jsx(Ve,{query:s,setQuery:t,setFocused:o,focused:r})]})]}),r&&s===""?e.jsx(ze,{historySearch:d,onSelect:p,onRemove:m,onClear:h}):r?s!==""&&e.jsx(ee,{data:l,query:s,onSelect:p}):e.jsx(Ze,{}),c&&e.jsx("p",{className:"mt-10 flex items-center justify-center",children:"Загрузка..."}),a&&e.jsxs("p",{className:"text-red-500",children:["Ошибка: ",(i==null?void 0:i.message)||"Неизвестная ошибка"]})]})}const Xe=j("/search")({component:et});function et(){return e.jsx("div",{className:"p-2",children:e.jsx(Ge,{})})}const tt=async()=>{const s=localStorage.getItem("access_token"),t=localStorage.getItem("refresh_token");if(!s&&!t)throw new Error("Нет токенов доступа");try{return await k.get("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${s}`}}),s}catch{const n=(await k.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"refresh_token",refresh_token:t}),{headers:{Authorization:`Basic ${btoa("d44bab85ff344e52908e5f90ec669cbc:74f2f6fbb0e4443da5af72448650465c")}`,"Content-Type":"application/x-www-form-urlencoded"}})).data.access_token;return localStorage.setItem("access_token",n),n}},q=async(s,t={})=>{var r;try{const o=await tt();if(!o)throw new Error("Нет действующего токена доступа");return(await k({url:`https://api.spotify.com/v1${s}`,headers:{Authorization:`Bearer ${o}`,...t.headers},...t})).data}catch(o){throw console.error(`Ошибка при запросе к Spotify API: ${s}`,((r=o.response)==null?void 0:r.data)||o.message),o}},st=async()=>{const s=localStorage.getItem("access_token");if(!s){console.log("Токен не найден");return}try{return(await k.get("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${s}`}})).data}catch(t){throw console.error("Error getting user:",t),t}},rt=async s=>{if(!localStorage.getItem("access_token"))return[];try{return(await q(`/me/top/${s}`,{params:{limit:10,time_range:"medium_term"}})).items}catch(r){return console.log(r),[]}},at=async()=>{if(!localStorage.getItem("access_token"))return console.error("Ошибка: Нет access_token"),[];try{return(await q("/me/player/recently-played",{params:{limit:10}})).items||[]}catch(t){return console.error("Ошибка при получении недавно прослушанных треков:",t),[]}},nt=async()=>{if(!localStorage.getItem("access_token"))return console.error("Ошибка: Нет access_token"),[];try{return(await q("/me/playlists",{params:{limit:10}})).items}catch(t){console.log(t)}};function ot(){const{data:s,isLoading:t,isError:r}=b({queryKey:["playlists"],queryFn:()=>nt()});return r&&console.log("Error on userPlaylist"),console.log(s),e.jsxs("div",{className:"gap-4 flex flex-col p-4",children:[e.jsx("h3",{className:"text-2xl pb-5",children:"Моя медиатека"}),s==null?void 0:s.map(o=>{var n,l;return e.jsxs("div",{className:"flex flex-row gap-4 items-center cursor-pointer",children:[e.jsx("img",{className:"w-20 h-20",src:(l=(n=o.images)==null?void 0:n[0])==null?void 0:l.url,alt:o.name}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{children:o.name}),e.jsx("span",{children:`${o.type} • ${o.owner.display_name}`})]})]},o.name)})]})}const ct=j("/playlist")({component:lt});function lt(){return e.jsx("div",{className:"p-2",children:e.jsx(ot,{})})}const it=j("/download")({component:dt});function dt(){return e.jsx("div",{className:"p-2",children:e.jsx("h3",{children:"Скачать приложение"})})}const ut=j("/callback")({component:mt});function mt(){return u.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("code");if(!s)return;(async()=>{var r;try{const o=await k.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"authorization_code",code:s,redirect_uri:"http://127.0.0.1:5173/callback"}),{headers:{Authorization:"Basic "+btoa("d44bab85ff344e52908e5f90ec669cbc:74f2f6fbb0e4443da5af72448650465c"),"Content-Type":"application/x-www-form-urlencoded"}}),{access_token:n,refresh_token:l}=o.data;localStorage.setItem("access_token",n),localStorage.setItem("refresh_token",l),setTimeout(()=>{window.location.href="/"},1e3)}catch(o){console.error("Ошибка авторизации Spotify:",((r=o.response)==null?void 0:r.data)||o)}})()},[]),e.jsx("div",{className:"text-center min-h-screen",children:e.jsxs("div",{role:"status",className:"text-center min-h-screen flex items-center justify-center",children:[e.jsxs("svg",{"aria-hidden":"true",className:"inline w-17 h-17 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),e.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),e.jsx("span",{className:"sr-only",children:"Loading..."})]})})}function ht({onToggleMenu:s}){const[t,r]=u.useState();return u.useEffect(()=>{(async()=>{try{const n=await st();r(n)}catch(n){console.log("Немогу получить данные",n)}})()},[]),e.jsxs("header",{className:"flex items-center justify-between text-white p-4 mb-5",children:[e.jsxs("div",{className:"flex gap-4 items-center text-xl font-bold",children:[e.jsxs("h1",{children:["Добро пожаловать, ",(t==null?void 0:t.display_name)||"Гость"]}),(t==null?void 0:t.country)&&e.jsx(ge,{code:t.country,style:{width:30,height:20}})]}),e.jsx(ye,{className:"hover:scale-110 transition-transform h-7 w-7 cursor-pointer",onClick:s})]})}const C={logMenu:["Войти","Зарегистрироваться"],mainMenu:["Акаунт","Профиль","Выйти","Premium"],secondaryMenu:["Справка","Скачать","Конфиденциальность","Условия"]};function pt({onCloseMenu:s}){const[t,r]=u.useState(C.logMenu),{secondaryMenu:o}=C;u.useEffect(()=>{const c=localStorage.getItem("access_token");r(c?C.mainMenu:C.logMenu)},[]);const n=()=>{localStorage.removeItem("access_token"),r(C.logMenu)},l=()=>{window.location.href=We(),r(C.mainMenu)};return e.jsxs("menu",{className:"mx-auto w-full h-full min-h-screen flex flex-col text-white font-bold gap-6 absolute top-0 left-0 bg-black px-10 py-13",children:[e.jsx(T,{className:"absolute right-4 top-4 text-4xl hover:scale-110 transition-transform h-7 w-7 cursor-pointer",onClick:s}),e.jsx("ul",{className:"flex flex-col gap-6",children:t.map((c,a)=>e.jsx("li",{onClick:c==="Войти"?l:c==="Выйти"?n:void 0,className:"text-2xl hover:scale-110 transition-transform duration-200 cursor-pointer",children:c},a))}),e.jsx("hr",{className:"w-5 my-5 border-1"}),e.jsx("ul",{className:"flex space-x-4 flex-col gap-6",children:o.map((c,a)=>e.jsx("li",{className:"hover:scale-110 transition-transform duration-200 cursor-pointer",children:c},a))})]})}const re=Z({name:"track",initialState:{selectedTrack:null},reducers:{setTrack:(s,t)=>{s.selectedTrack=t.payload}}}),{setTrack:xt}=re.actions,ft=re.reducer;function A({header:s,item:t,hideItem:r}){const o=V(),n=a=>{const i=album.track||album;o(xt(i))},l=a=>{var d,m,h,p,x;const i=(a==null?void 0:a.track)||a;return((h=(m=(d=i==null?void 0:i.album)==null?void 0:d.images)==null?void 0:m[0])==null?void 0:h.url)||((x=(p=i==null?void 0:i.images)==null?void 0:p[0])==null?void 0:x.url)||null},c=a=>{var i,d;return a!=null&&a.type&&(a!=null&&a.id)?`/${a.type}/${a.id}`:`/${(i=a==null?void 0:a.track)==null?void 0:i.type}/${(d=a==null?void 0:a.track)==null?void 0:d.id}`};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-xl font-bold items-start pl-4 mb-5",children:s}),e.jsx("div",{className:`flex flex-row items-baseline justify-baseline \r
          overflow-x-auto snap-x snap-mandatory scroll-smooth gap-4 px-4 `,children:t==null?void 0:t.map(a=>{var i,d,m,h;return e.jsx(I,{to:c(a),state:{name:a.name,image:((d=(i=a.images)==null?void 0:i[0])==null?void 0:d.url)??null,followers:a.followers,obj:a.track||a},children:e.jsxs("div",{onClick:()=>n(),className:`flex flex-col items-start justify-baseline flex-shrink-0\r
                  snap-center mb-10 h-auto cursor-pointer`,children:[e.jsx("img",{src:l(a),alt:a.name,className:"object-cover flex-shrink-0 rounded-lg max-w-[170px] max-h-[170px]"}),e.jsxs("div",{className:"flex flex-col items-start justify-center mt-3",children:[e.jsx("h2",{className:"text-sm/tight font-bold max-w-[170px]",children:a.name||a.track.name}),e.jsx("p",{children:r?"":`${a==null?void 0:a.type} • ${(m=a==null?void 0:a.release_date)==null?void 0:m.slice(0,4)}`})]})]})},(a==null?void 0:a.id)||((h=a==null?void 0:a.track)==null?void 0:h.id))})})]})}const U=s=>b({queryKey:["topItems",s],queryFn:s==="recently"?at:()=>rt(s)});function gt(){const{data:s,isLoading:t,isError:r}=U("artists");return e.jsx(e.Fragment,{children:e.jsx(A,{header:"Любимые исполнители",item:s,hideItem:!0})})}function yt(){const{data:s,isLoading:t,isError:r}=U("tracks");return e.jsx(A,{header:"Любимые треки",item:s,hideItem:!0})}function jt(){const{data:s,isLoading:t,isError:r}=U("recently");return e.jsx(A,{header:"Недавно слушал",item:s,hideItem:!0})}function wt(){const s=localStorage.getItem("access_token");return e.jsx(e.Fragment,{children:s?e.jsxs(e.Fragment,{children:[e.jsx(gt,{}),e.jsx(yt,{}),e.jsx(jt,{})]}):e.jsx("h1",{className:"pl-4",children:"Пожалуйста войдите в свой акаунт"})})}const bt=j("/")({component:Nt});function Nt(){const[s,t]=u.useState(!1),r=()=>{t(o=>!o)};return e.jsxs(e.Fragment,{children:[e.jsx(ht,{onToggleMenu:r}),s&&e.jsx(pt,{onCloseMenu:r}),e.jsx(wt,{})]})}function ae({tracks:s,artist:t}){return e.jsxs("div",{className:"mt-10",children:[e.jsxs("h1",{className:"p-4 text-xl",children:["Популярные треки ",t]}),s==null?void 0:s.map(r=>{var o,n,l,c;return e.jsx(I,{to:`/${r.type}/${r.id}`,state:{name:r.name,image:((n=(o=r.images)==null?void 0:o[0])==null?void 0:n.url)??null,followers:r.followers,obj:r},children:e.jsxs("div",{style:r.is_playable?{}:{opacity:.2},className:"flex items-center gap-4 p-4",onClick:()=>console.log(r),children:[e.jsx("img",{width:"80",height:"80",className:"w-[80px] h-[80px]",src:(c=(l=r.album.images)==null?void 0:l[0])==null?void 0:c.url,alt:r.name}),e.jsxs("div",{className:"flex flex-col items-start justify-center mt-3",children:[e.jsx("h1",{children:r.name}),e.jsxs("p",{className:"flex items-center gap-2",children:[Math.floor(r.duration_ms/1e3/60),".",Math.floor(r.duration_ms/1e3%60).toString().padStart(2,"0")," ","min",r.explicit&&e.jsx(je,{}),r.popularity>85&&e.jsx(we,{className:"fill-amber-700"})]}),!r.is_playable&&e.jsxs("span",{className:"text-gray-500 text-xs flex items-center gap-2",children:[e.jsx(be,{})," Недоступно в вашем регионе"]})]})]})},r.id||r.track.id)})]})}function ne({albums:s}){return e.jsx(e.Fragment,{children:e.jsx(A,{header:"Альбомы",item:s,hideItem:!1})})}function vt(){const{player:s,isPlaying:t,togglePlay:r,duration:o,elapsed:n}=F(),[l,c]=u.useState(0);return u.useEffect(()=>{s&&n>=0&&c(n/o*100)},[n,s,o]),e.jsxs("div",{className:"flex justify-between items-center mt-4 pb-3",children:[e.jsx(K,{className:"text-3xl mr-3 object-contain flex-shrink-0 fill-white/50"}),e.jsx("button",{onClick:r,className:"text-2xl mr-3 object-contain flex-shrink-0 bg-green-600 rounded-full w-15 h-15 flex items-center justify-center",children:t?e.jsx(W,{className:"fill-black w-5 h-5"}):e.jsx(Y,{className:"fill-black w-5 h-5"})})]})}function kt(){var d,m,h,p,x,y,S,R,$,f,g,N,v,P,E;const s=L(),{obj:t}=s.state,r=(m=(d=t==null?void 0:t.artists)==null?void 0:d[0])==null?void 0:m.id;(h=t==null?void 0:t.album)==null||h.id,console.log(t);const{data:o,isLoading:n,isError:l}=b({queryKey:["tracks",r],queryFn:()=>te(r)}),{data:c,isLoading:a,isError:i}=b({queryKey:["albums",r],queryFn:()=>M(r)});return(l||i)&&console.log("Error with loading artist top tracks"),e.jsxs("div",{children:[e.jsxs("div",{className:" bg-gradient-to-b from-orange-500 to-black-900 p-4",children:[e.jsx(se,{}),e.jsx("div",{className:"flex flex-col items-center justify-center",children:e.jsx("img",{width:"200",height:"200",className:" w-[200px] h-[200px] object-cover flex items-center justify-center shrink-0",src:((y=(x=(p=t.track)==null?void 0:p.album.images)==null?void 0:x[0])==null?void 0:y.url)||((R=(S=t==null?void 0:t.album.images)==null?void 0:S[0])==null?void 0:R.url),alt:""})}),e.jsxs("div",{className:"flex flex-col pt-4 gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold items-start",children:t.name}),e.jsx("div",{className:"flex gap-3",children:($=t==null?void 0:t.artists)==null?void 0:$.map(D=>e.jsx("span",{children:D.name},D.name))}),e.jsxs("div",{className:"flex gap-2 text-white/60",children:[e.jsx("span",{children:(f=t==null?void 0:t.album)==null?void 0:f.release_date.slice(0,4)})," •",e.jsx("span",{children:((g=t==null?void 0:t.album)==null?void 0:g.total_tracks)===1?`${(N=t==null?void 0:t.album)==null?void 0:N.total_tracks} трек`:`${(v=t==null?void 0:t.album)==null?void 0:v.total_tracks} треков`})," ","•",e.jsxs("span",{children:[Math.floor(t.duration_ms/1e3/60),":",Math.floor(t.duration_ms/1e3%60).toString().padStart(2,"0")," "]})]})]}),e.jsx(vt,{})]}),e.jsx(ae,{artist:(E=(P=t==null?void 0:t.artists)==null?void 0:P[0])==null?void 0:E.name,tracks:o}),e.jsx(ne,{albums:c})]})}const Pt=j("/track/$trackId")({component:It});function It(){return e.jsx("div",{children:e.jsx(kt,{})})}const St=j("/playlist/playlistId")({component:Ct});function Ct(){return e.jsx("div",{children:'Hello "/playlist/playlistId"!'})}const Rt=j("/artist/$id")({component:$t});function $t(){return e.jsx("div",{children:'Hello "/artist/$id"!'})}function Et({artistInfo:s}){var a;const{name:t,image:r,followers:o,searchQuery:n}=s||{},l=J(),c=()=>{l.navigate({to:"/search",replace:!0,state:{searchQuery:n}})};return e.jsxs("div",{className:"m-4",children:[e.jsx(Q,{className:"m-4 w-8 h-8 cursor-pointer",onClick:c}),e.jsx("div",{className:"flex flex-col items-center justify-center",children:e.jsx("img",{width:"200",height:"200",className:"rounded-full w-[200px] h-[200px] object-cover flex items-center justify-center shrink-0",src:r,alt:""})}),e.jsxs("div",{className:"flex flex-col items-center justify-center pt-4",children:[e.jsx("h1",{className:"text-2xl font-bold items-start",children:((a=t==null?void 0:t.charAt(0))==null?void 0:a.toUpperCase())+(t==null?void 0:t.slice(1))}),e.jsxs("p",{children:[" ",new Intl.NumberFormat().format(o==null?void 0:o.total)," - фоловеров"]})]})]})}function _t(){const s=L(),t=Ne({from:"/artist/$artistId",select:i=>i.artistId}),{data:r,isLoading:o,error:n}=b({queryKey:["artist",t],queryFn:()=>M(t)}),{data:l,isLoading:c,error:a}=b({queryKey:["tracks",t],queryFn:()=>te(t)});return o||c?e.jsx("div",{className:"mx-auto my-auto flex justify-center items-center",children:"Loading..."}):n||a?(console.log("artistId passed to useQuery:",t),e.jsxs("div",{children:["Error: ",(n==null?void 0:n.message)||(a==null?void 0:a.message)]})):e.jsxs("div",{children:[e.jsx(Et,{artistInfo:s.state}),e.jsx(ae,{tracks:l}),e.jsx(ne,{albums:r})]})}const At=j("/artist/$artistId")({component:_t}),Tt=j("/album/$albumId")({component:Lt});function Lt(){return e.jsx("div",{children:'Hello "/album/$albumId"!'})}const Ft=Xe.update({id:"/search",path:"/search",getParentRoute:()=>w}),oe=ct.update({id:"/playlist",path:"/playlist",getParentRoute:()=>w}),Mt=it.update({id:"/download",path:"/download",getParentRoute:()=>w}),qt=ut.update({id:"/callback",path:"/callback",getParentRoute:()=>w}),Ut=bt.update({id:"/",path:"/",getParentRoute:()=>w}),Dt=Pt.update({id:"/track/$trackId",path:"/track/$trackId",getParentRoute:()=>w}),Ot=St.update({id:"/playlistId",path:"/playlistId",getParentRoute:()=>oe}),Bt=Rt.update({id:"/artist/$id",path:"/artist/$id",getParentRoute:()=>w}),Ht=At.update({id:"/artist/$artistId",path:"/artist/$artistId",getParentRoute:()=>w}),Vt=Tt.update({id:"/album/$albumId",path:"/album/$albumId",getParentRoute:()=>w}),zt={PlaylistPlaylistIdRoute:Ot},Kt=oe._addFileChildren(zt),Wt={IndexRoute:Ut,CallbackRoute:qt,DownloadRoute:Mt,PlaylistRoute:Kt,SearchRoute:Ft,AlbumAlbumIdRoute:Vt,ArtistArtistIdRoute:Ht,ArtistIdRoute:Bt,TrackTrackIdRoute:Dt},Yt=w._addFileChildren(Wt)._addFileTypes(),Jt=$e({reducer:{player:qe,track:ft}}),Qt=ve({routeTree:Yt}),Zt=new Re({defaultOptions:{queries:{staleTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}}}),H=document.getElementById("root");H.innerHTML||ke.createRoot(H).render(e.jsx(Pe,{client:Zt,children:e.jsx(Ie,{store:Jt,children:e.jsx(Ue,{children:e.jsx(Se,{router:Qt})})})}));
