import{j as e,L as k,P as ee,B as te,S as se,A as re,a as u,c as ae,O as oe,C as ne,M as _,R as ce,T as le,V as ie,u as E,b as j,d as B,I as H,e as g,F as de,f as ue,g as me,h as he,i as xe,k as pe,l as fe,m as ge,n as ye,o as je,p as we,q as ke,Q as Ne,s as be,t as ve}from"./react-vendor-ES8h0Vmw.js";import{E as N,F as Ie,G as Pe,H as Se}from"./vendor-CRHJ5-yc.js";import{c as D,a as Ce}from"./redux-Cc6_CetH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();const $e=()=>e.jsxs("nav",{className:"flex flex-row justify-between text-white bg-black w-full fixed bottom-0 z-10 border-t border-gray-300",children:[e.jsx(k,{to:"/",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(ee,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Главная"})]})}),e.jsx(k,{to:"/search",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(te,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Поиск"})]})}),e.jsx(k,{to:"/playlist",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(se,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Моя медиатека"})]})}),e.jsx(k,{to:"/download",className:"group text-gray-600 [&.active]:text-white",children:e.jsxs("div",{className:"flex flex-col items-center p-4 cursor-pointer",children:[e.jsx(re,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px]",children:"Скачать приложение"})]})})]}),z=u.createContext({player:null,isPlaying:!1,duration:0,elapsed:0,setPlayer:s=>{},togglePlay:()=>{},setDuration:s=>{},setElapsed:s=>{}}),K=({children:s})=>{const[t,r]=u.useState(null),[a,n]=u.useState(!1),[l,c]=u.useState(0),[o,i]=u.useState(0),d=u.useCallback(()=>{t&&(a?t.pauseVideo():t.playVideo(),n(m=>!m))},[t,a]);return e.jsx(z.Provider,{value:{player:t,isPlaying:a,duration:l,elapsed:o,setPlayer:r,togglePlay:d,setDuration:c,setElapsed:i},children:s})},Re=()=>u.useContext(z);function Te({children:s}){return e.jsx(e.Fragment,{children:e.jsxs(K,{children:[e.jsx("main",{className:"mb-30",children:s}),e.jsx($e,{})]})})}const y=ae({component:()=>e.jsx(Te,{children:e.jsx(oe,{})})});function Ae({query:s,setQuery:t,setFocused:r,focused:a}){return e.jsxs("div",{className:"flex w-full items-center gap-3 h-10 p-3 pl-4 justify-between bg-white text-md rounded",children:[e.jsx(ne,{className:`fill-black  ${a?"w-6 h-6":"w-8 h-8"}`}),e.jsx("input",{type:"text",className:`w-full rounded border-0 not-[]:focus:outline-none \r
            focus:ring-0 focus:border-transparent focus:text-bold focus-visible:outline-none caret-cyan-950\r
             text-cyan-950 placeholder-gray-500 font-semibold placeholder:font-normal`,placeholder:"Что хочешь послушать?",value:s,onChange:n=>t(n.target.value),onFocus:()=>r(!0)}),s&&e.jsx(_,{onClick:()=>t(""),className:"fill-black w-7 h-7 cursor-pointer"})]})}const V=ce.memo(function({data:t,onSelect:r,histored:a,onRemove:n,query:l}){return e.jsx("ul",{className:"space-y-2 mt-5",children:t==null?void 0:t.map(c=>{var o,i,d,m;return e.jsx(k,{to:`/artist/${c.id}`,state:{name:c.name,image:((i=(o=c.images)==null?void 0:o[0])==null?void 0:i.url)??null,followers:c.followers,searchQuery:l},className:"flex flex-col gap-2",children:e.jsxs("li",{className:"p-2 rounded shadow flex items-center gap-4 cursor-pointer",onClick:()=>{r(c)},children:[c.images&&c.images.length>0?e.jsx("img",{src:(m=(d=c.images)==null?void 0:d[0])==null?void 0:m.url,alt:c.name,width:"70",height:"70",className:"w-[70px] h-[70px] rounded-full mt-2 object-cover shrink-0"}):e.jsx("span",{className:"w-15 h-15 rounded-full mt-2 bg-gray-700",children:e.jsx(le,{className:"flex items-center justify-center text-6xl text-purple-600"})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-bold",children:c.name}),e.jsx(ie,{className:"fill-blue-400 w-5 h-5 shrink-0"})]}),e.jsx("p",{className:"font-bold text-xs text-gray-500",children:c.type.charAt(0).toUpperCase()+c.type.slice(1).toLowerCase()})]}),a&&e.jsx("button",{onClick:x=>{x.stopPropagation(),x.preventDefault(),n==null||n(c.id)},children:e.jsx(_,{width:"28",height:"28",className:`w-[28px] h-[28px] object-cover shrink-0 cursor-pointer \r
                    hover:scale-110 transition-transform duration-200`})})]})]})},c.id)})})});function _e({historySearch:s,onSelect:t,onRemove:r,onClear:a}){return s.length===0?e.jsxs("div",{className:"flex flex-col mt-10 gap-5",children:[e.jsx("h2",{className:"font-bold text-xl",children:"Слушай то, что нравится"}),e.jsx("h3",{className:"text-sm",children:"Находи исполнителей, треки, подкасты и не только."})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{data:s,histored:!0,onSelect:t,onRemove:r}),e.jsx("button",{className:"flex px-5 py-2 text-white rounded-xl font-semibold mx-auto mt-4 border-white border-1 cursor-pointer hover:bg-gray-700 transition-colors duration-300",onClick:a,children:"Очистить историю"})]})}const Ee=async()=>{var r;const s="d44bab85ff344e52908e5f90ec669cbc",t="74f2f6fbb0e4443da5af72448650465c";try{return(await N.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"client_credentials"}),{headers:{Authorization:`Basic ${btoa(`${s}:${t}`)}`,"Content-Type":"application/x-www-form-urlencoded"}})).data.access_token}catch(a){throw console.error("Error fetching Access Token:",((r=a.response)==null?void 0:r.data)||a.message),a}},Fe=()=>{const s="https://accounts.spotify.com/authorize",t="d44bab85ff344e52908e5f90ec669cbc",r=encodeURIComponent("http://127.0.0.1:5173/callback"),a="code",n=["user-read-private","user-read-email","user-top-read","user-library-read","playlist-modify-public","playlist-modify-private","user-read-playback-state","user-modify-playback-state","user-follow-read","user-read-recently-played","streaming","app-remote-control","ugc-image-upload","user-read-currently-playing","playlist-read-collaborative","playlist-read-private"].join(" ");return`${s}?client_id=${t}&response_type=${a}&redirect_uri=${r}&scope=${encodeURIComponent(n)}`},C=async(s,t={})=>{var r;try{const a=await Ee();return(await N({url:`https://api.spotify.com/v1${s}`,headers:{Authorization:`Bearer ${a}`,...t.headers},...t})).data}catch(a){throw console.error(`Error making Spotify API request to ${s}:`,((r=a.response)==null?void 0:r.data)||a.message),a}},Le=async s=>{if(!(s!=null&&s.trim()))return[];try{return(await C("/search",{params:{q:s,type:"artist",limit:20}})).artists.items}catch(t){throw console.error("Error searching artists:",t),t}},Q=async s=>{try{return(await C(`/artists/${s}/top-tracks`,{params:{market:"US"}})).tracks}catch(t){throw console.error("Error getting artist top tracks:",t),t}},F=async s=>{try{return(await C(`/artists/${s}/albums`,{params:{market:"US",limit:10}})).items}catch(t){throw console.error("Error getting artist albums:",t),t}},Me=async()=>{try{return(await C("/browse/categories",{params:{limit:50}})).categories.items}catch(s){console.log(s)}};function Ue(){const[s,t]=u.useState(""),[r,a]=u.useState(!1),[n,l]=u.useState(""),[c,o]=u.useState([]),[i]=Ie(s,500),d=E(),{data:m,isLoading:x,isError:f,error:w}=j({queryKey:["tracks",i],queryFn:()=>Le(i),enabled:!!(i!=null&&i.trim()),retry:1});u.useEffect(()=>{var p;const h=((p=d.state)==null?void 0:p.searchQuery)||"";h&&(t(h),a(!0))},[d.state]),u.useEffect(()=>{const h=JSON.parse(localStorage.getItem("historySearch")||"[]");o(h)},[]);const v=h=>{o(p=>{if(p.some(S=>S.id===h.id))return p;const P=[h,...p];return localStorage.setItem("historySearch",JSON.stringify(P)),P})};return{query:s,setQuery:t,focused:r,setFocused:a,navBack:()=>{s!==""?(t(""),a(!0)):a(!1)},data:m,isLoading:x,isError:f,error:w,historySearch:c,addToHistory:v,removeFromHistory:h=>{const p=c.filter(I=>I.id!==h);o(p),localStorage.setItem("historySearch",JSON.stringify(p))},clearHistory:()=>{localStorage.clear(),o([])},onSelectArtist:h=>{l(h.id),F(h.id),v(h)}}}function qe(){const{data:s,isLoading:t,isError:r}=j({queryKey:["categories"],queryFn:()=>Me()});r&&console.log("Error, cant load categories"),console.log(s);const a=()=>{let n="#";for(let l=0;l<6;l++)n+=(Math.random()*9).toFixed(0);return n};return e.jsxs("div",{children:[e.jsx("h2",{className:"pb-5 text-white text-lg font-bold mt-4",children:"Все остальное"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:s==null?void 0:s.map((n,l)=>{var o,i;const c=a();return e.jsxs("div",{className:"h-24 p-2 font-bold rounded relative overflow-hidden",style:{backgroundColor:c},children:[n.name,e.jsx("img",{className:"w-17 h-17 absolute right-0 inset-x-37 bottom-0 rotate-25",src:(i=(o=n.icons)==null?void 0:o[0])==null?void 0:i.url,alt:n.name})]},l)})})]})}function J(){const{history:s}=B();return e.jsx(H,{className:"w-8 h-8 cursor-pointer",onClick:()=>s.go(-1)})}function Oe(){const{query:s,setQuery:t,focused:r,setFocused:a,navBack:n,data:l,isLoading:c,isError:o,error:i,historySearch:d,removeFromHistory:m,clearHistory:x,onSelectArtist:f}=Ue();return e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"flex flex-col p-4",children:[!r&&e.jsx("h1",{className:"pb-5 text-white text-3xl",children:"Искать"}),e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[r&&e.jsx(J,{onClick:n}),e.jsx(Ae,{query:s,setQuery:t,setFocused:a,focused:r})]})]}),r&&s===""?e.jsx(_e,{historySearch:d,onSelect:f,onRemove:m,onClear:x}):r?s!==""&&e.jsx(V,{data:l,query:s,onSelect:f}):e.jsx(qe,{}),c&&e.jsx("p",{className:"mt-10 flex items-center justify-center",children:"Загрузка..."}),o&&e.jsxs("p",{className:"text-red-500",children:["Ошибка: ",(i==null?void 0:i.message)||"Неизвестная ошибка"]})]})}const Be=g("/search")({component:He});function He(){return e.jsx("div",{className:"p-2",children:e.jsx(Oe,{})})}const De=async()=>{const s=localStorage.getItem("access_token"),t=localStorage.getItem("refresh_token");if(!s&&!t)throw new Error("Нет токенов доступа");try{return await N.get("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${s}`}}),s}catch{const n=(await N.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"refresh_token",refresh_token:t}),{headers:{Authorization:`Basic ${btoa("d44bab85ff344e52908e5f90ec669cbc:74f2f6fbb0e4443da5af72448650465c")}`,"Content-Type":"application/x-www-form-urlencoded"}})).data.access_token;return localStorage.setItem("access_token",n),n}},L=async(s,t={})=>{var r;try{const a=await De();if(!a)throw new Error("Нет действующего токена доступа");return(await N({url:`https://api.spotify.com/v1${s}`,headers:{Authorization:`Bearer ${a}`,...t.headers},...t})).data}catch(a){throw console.error(`Ошибка при запросе к Spotify API: ${s}`,((r=a.response)==null?void 0:r.data)||a.message),a}},ze=async()=>{const s=localStorage.getItem("access_token");if(!s){console.log("Токен не найден");return}try{return(await N.get("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${s}`}})).data}catch(t){throw console.error("Error getting user:",t),t}},Ke=async s=>{if(!localStorage.getItem("access_token"))return[];try{return(await L(`/me/top/${s}`,{params:{limit:10,time_range:"medium_term"}})).items}catch(r){return console.log(r),[]}},Ve=async()=>{if(!localStorage.getItem("access_token"))return console.error("Ошибка: Нет access_token"),[];try{return(await L("/me/player/recently-played",{params:{limit:10}})).items||[]}catch(t){return console.error("Ошибка при получении недавно прослушанных треков:",t),[]}},Qe=async()=>{if(!localStorage.getItem("access_token"))return console.error("Ошибка: Нет access_token"),[];try{return(await L("/me/playlists",{params:{limit:10}})).items}catch(t){console.log(t)}};function Je(){const{data:s,isLoading:t,isError:r}=j({queryKey:["playlists"],queryFn:()=>Qe()});return r&&console.log("Error on userPlaylist"),console.log(s),e.jsxs("div",{className:"gap-4 flex flex-col p-4",children:[e.jsx("h3",{className:"text-2xl pb-5",children:"Моя медиатека"}),s==null?void 0:s.map(a=>{var n,l;return e.jsxs("div",{className:"flex flex-row gap-4 items-center cursor-pointer",children:[e.jsx("img",{className:"w-20 h-20",src:(l=(n=a.images)==null?void 0:n[0])==null?void 0:l.url,alt:a.name}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{children:a.name}),e.jsx("span",{children:`${a.type} • ${a.owner.display_name}`})]})]},a.name)})]})}const Ze=g("/playlist")({component:We});function We(){return e.jsx("div",{className:"p-2",children:e.jsx(Je,{})})}const Ge=g("/download")({component:Ye});function Ye(){return e.jsx("div",{className:"p-2",children:e.jsx("h3",{children:"Скачать приложение"})})}const Xe=g("/callback")({component:et});function et(){return u.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("code");if(!s)return;(async()=>{var r;try{const a=await N.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"authorization_code",code:s,redirect_uri:"http://127.0.0.1:5173/callback"}),{headers:{Authorization:"Basic "+btoa("d44bab85ff344e52908e5f90ec669cbc:74f2f6fbb0e4443da5af72448650465c"),"Content-Type":"application/x-www-form-urlencoded"}}),{access_token:n,refresh_token:l}=a.data;localStorage.setItem("access_token",n),localStorage.setItem("refresh_token",l),setTimeout(()=>{window.location.href="/"},1e3)}catch(a){console.error("Ошибка авторизации Spotify:",((r=a.response)==null?void 0:r.data)||a)}})()},[]),e.jsx("div",{className:"text-center min-h-screen",children:e.jsxs("div",{role:"status",className:"text-center min-h-screen flex items-center justify-center",children:[e.jsxs("svg",{"aria-hidden":"true",className:"inline w-17 h-17 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),e.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),e.jsx("span",{className:"sr-only",children:"Loading..."})]})})}function tt({onToggleMenu:s}){const[t,r]=u.useState();return u.useEffect(()=>{(async()=>{try{const n=await ze();r(n)}catch(n){console.log("Немогу получить данные",n)}})()},[]),e.jsxs("header",{className:"flex items-center justify-between text-white p-4 mb-5",children:[e.jsxs("div",{className:"flex gap-4 items-center text-xl font-bold",children:[e.jsxs("h1",{children:["Добро пожаловать, ",(t==null?void 0:t.display_name)||"Гость"]}),(t==null?void 0:t.country)&&e.jsx(de,{code:t.country,style:{width:30,height:20}})]}),e.jsx(ue,{className:"hover:scale-110 transition-transform h-7 w-7 cursor-pointer",onClick:s})]})}const b={logMenu:["Войти","Зарегистрироваться"],mainMenu:["Акаунт","Профиль","Выйти","Premium"],secondaryMenu:["Справка","Скачать","Конфиденциальность","Условия"]};function st({onCloseMenu:s}){const[t,r]=u.useState(b.logMenu),{secondaryMenu:a}=b;u.useEffect(()=>{const c=localStorage.getItem("access_token");r(c?b.mainMenu:b.logMenu)},[]);const n=()=>{localStorage.removeItem("access_token"),r(b.logMenu)},l=()=>{window.location.href=Fe(),r(b.mainMenu)};return e.jsxs("menu",{className:"mx-auto w-full h-full min-h-screen flex flex-col text-white font-bold gap-6 absolute top-0 left-0 bg-black px-10 py-13",children:[e.jsx(_,{className:"absolute right-4 top-4 text-4xl hover:scale-110 transition-transform h-7 w-7 cursor-pointer",onClick:s}),e.jsx("ul",{className:"flex flex-col gap-6",children:t.map((c,o)=>e.jsx("li",{onClick:c==="Войти"?l:c==="Выйти"?n:void 0,className:"text-2xl hover:scale-110 transition-transform duration-200 cursor-pointer",children:c},o))}),e.jsx("hr",{className:"w-5 my-5 border-1"}),e.jsx("ul",{className:"flex space-x-4 flex-col gap-6",children:a.map((c,o)=>e.jsx("li",{className:"hover:scale-110 transition-transform duration-200 cursor-pointer",children:c},o))})]})}const Z=D({name:"track",initialState:{selectedTrack:null},reducers:{setTrack:(s,t)=>{s.selectedTrack=t.payload}}}),{setTrack:rt}=Z.actions,at=Z.reducer;function $({header:s,item:t,hideItem:r}){const a=me(),n=o=>{const i=album.track||album;a(rt(i))},l=o=>{var d,m,x,f,w;const i=(o==null?void 0:o.track)||o;return((x=(m=(d=i==null?void 0:i.album)==null?void 0:d.images)==null?void 0:m[0])==null?void 0:x.url)||((w=(f=i==null?void 0:i.images)==null?void 0:f[0])==null?void 0:w.url)||null},c=o=>{var i,d;return o!=null&&o.type&&(o!=null&&o.id)?`/${o.type}/${o.id}`:`/${(i=o==null?void 0:o.track)==null?void 0:i.type}/${(d=o==null?void 0:o.track)==null?void 0:d.id}`};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-xl font-bold items-start pl-4 mb-5",children:s}),e.jsx("div",{className:`flex flex-row items-baseline justify-baseline \r
          overflow-x-auto snap-x snap-mandatory scroll-smooth gap-4 px-4 `,children:t==null?void 0:t.map(o=>{var i,d,m,x;return e.jsx(k,{to:c(o),state:{name:o.name,image:((d=(i=o.images)==null?void 0:i[0])==null?void 0:d.url)??null,followers:o.followers,obj:o.track||o},children:e.jsxs("div",{onClick:()=>n(),className:`flex flex-col items-start justify-baseline flex-shrink-0\r
                  snap-center mb-10 h-auto cursor-pointer`,children:[e.jsx("img",{src:l(o),alt:o.name,className:"object-cover flex-shrink-0 rounded-lg max-w-[170px] max-h-[170px]"}),e.jsxs("div",{className:"flex flex-col items-start justify-center mt-3",children:[e.jsx("h2",{className:"text-sm/tight font-bold max-w-[170px]",children:o.name||o.track.name}),e.jsx("p",{children:r?"":`${o==null?void 0:o.type} • ${(m=o==null?void 0:o.release_date)==null?void 0:m.slice(0,4)}`})]})]})},(o==null?void 0:o.id)||((x=o==null?void 0:o.track)==null?void 0:x.id))})})]})}const M=s=>j({queryKey:["topItems",s],queryFn:s==="recently"?Ve:()=>Ke(s)});function ot(){const{data:s,isLoading:t,isError:r}=M("artists");return e.jsx(e.Fragment,{children:e.jsx($,{header:"Любимые исполнители",item:s,hideItem:!0})})}function nt(){const{data:s,isLoading:t,isError:r}=M("tracks");return e.jsx($,{header:"Любимые треки",item:s,hideItem:!0})}function ct(){const{data:s,isLoading:t,isError:r}=M("recently");return e.jsx($,{header:"Недавно слушал",item:s,hideItem:!0})}function lt(){const s=localStorage.getItem("access_token");return e.jsx(e.Fragment,{children:s?e.jsxs(e.Fragment,{children:[e.jsx(ot,{}),e.jsx(nt,{}),e.jsx(ct,{})]}):e.jsx("h1",{className:"pl-4",children:"Пожалуйста войдите в свой акаунт"})})}const it=g("/")({component:dt});function dt(){const[s,t]=u.useState(!1),r=()=>{t(a=>!a)};return e.jsxs(e.Fragment,{children:[e.jsx(tt,{onToggleMenu:r}),s&&e.jsx(st,{onCloseMenu:r}),e.jsx(lt,{})]})}function W({tracks:s,artist:t}){return e.jsxs("div",{className:"mt-10",children:[e.jsxs("h1",{className:"p-4 text-xl",children:["Популярные треки ",t]}),s==null?void 0:s.map(r=>{var a,n,l,c;return e.jsx(k,{to:`/${r.type}/${r.id}`,state:{name:r.name,image:((n=(a=r.images)==null?void 0:a[0])==null?void 0:n.url)??null,followers:r.followers,obj:r},children:e.jsxs("div",{style:r.is_playable?{}:{opacity:.2},className:"flex items-center gap-4 p-4",onClick:()=>console.log(r),children:[e.jsx("img",{width:"80",height:"80",className:"w-[80px] h-[80px]",src:(c=(l=r.album.images)==null?void 0:l[0])==null?void 0:c.url,alt:r.name}),e.jsxs("div",{className:"flex flex-col items-start justify-center mt-3",children:[e.jsx("h1",{children:r.name}),e.jsxs("p",{className:"flex items-center gap-2",children:[Math.floor(r.duration_ms/1e3/60),".",Math.floor(r.duration_ms/1e3%60).toString().padStart(2,"0")," ","min",r.explicit&&e.jsx(he,{}),r.popularity>85&&e.jsx(xe,{className:"fill-amber-700"})]}),!r.is_playable&&e.jsxs("span",{className:"text-gray-500 text-xs flex items-center gap-2",children:[e.jsx(pe,{})," Недоступно в вашем регионе"]})]})]})},r.id||r.track.id)})]})}function G({albums:s}){return e.jsx(e.Fragment,{children:e.jsx($,{header:"Альбомы",item:s,hideItem:!1})})}const ut={isPlaying:!1,isPlayerVisible:!1},Y=D({name:"player",initialState:ut,reducers:{togglePlay(s){s.isPlaying=!s.isPlaying},setIsPlaying(s,t){s.isPlaying=t.payload},setPlayerVisibility(s,t){s.isPlayerVisible=t.payload}}}),{togglePlay:Vt,setIsPlaying:Qt,setPlayerVisibility:Jt}=Y.actions,mt=Y.reducer;function ht(){const{player:s,isPlaying:t,togglePlay:r,duration:a,elapsed:n}=Re(),[l,c]=u.useState(0);return u.useEffect(()=>{s&&n>=0&&c(n/a*100)},[n,s,a]),e.jsxs("div",{className:"flex justify-between items-center mt-4 pb-3",children:[e.jsx(fe,{className:"text-3xl mr-3 object-contain flex-shrink-0 fill-white/50"}),e.jsx("button",{onClick:r,className:"text-2xl mr-3 object-contain flex-shrink-0 bg-green-600 rounded-full w-15 h-15 flex items-center justify-center",children:t?e.jsx(ge,{className:"fill-black w-5 h-5"}):e.jsx(ye,{className:"fill-black w-5 h-5"})})]})}function xt(){var d,m,x,f,w,v,R,T,A,h,p,I,P,S,U;const s=E(),{obj:t}=s.state,r=(m=(d=t==null?void 0:t.artists)==null?void 0:d[0])==null?void 0:m.id;(x=t==null?void 0:t.album)==null||x.id,console.log(t);const{data:a,isLoading:n,isError:l}=j({queryKey:["tracks",r],queryFn:()=>Q(r)}),{data:c,isLoading:o,isError:i}=j({queryKey:["albums",r],queryFn:()=>F(r)});return(l||i)&&console.log("Error with loading artist top tracks"),e.jsxs("div",{children:[e.jsxs("div",{className:" bg-gradient-to-b from-orange-500 to-black-900 p-4",children:[e.jsx(J,{}),e.jsx("div",{className:"flex flex-col items-center justify-center",children:e.jsx("img",{width:"200",height:"200",className:" w-[200px] h-[200px] object-cover flex items-center justify-center shrink-0",src:((v=(w=(f=t.track)==null?void 0:f.album.images)==null?void 0:w[0])==null?void 0:v.url)||((T=(R=t==null?void 0:t.album.images)==null?void 0:R[0])==null?void 0:T.url),alt:""})}),e.jsxs("div",{className:"flex flex-col pt-4 gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold items-start",children:t.name}),e.jsx("div",{className:"flex gap-3",children:(A=t==null?void 0:t.artists)==null?void 0:A.map(q=>e.jsx("span",{children:q.name},q.name))}),e.jsxs("div",{className:"flex gap-2 text-white/60",children:[e.jsx("span",{children:(h=t==null?void 0:t.album)==null?void 0:h.release_date.slice(0,4)})," •",e.jsx("span",{children:((p=t==null?void 0:t.album)==null?void 0:p.total_tracks)===1?`${(I=t==null?void 0:t.album)==null?void 0:I.total_tracks} трек`:`${(P=t==null?void 0:t.album)==null?void 0:P.total_tracks} треков`})," ","•",e.jsxs("span",{children:[Math.floor(t.duration_ms/1e3/60),":",Math.floor(t.duration_ms/1e3%60).toString().padStart(2,"0")," "]})]})]}),e.jsx(ht,{})]}),e.jsx(W,{artist:(U=(S=t==null?void 0:t.artists)==null?void 0:S[0])==null?void 0:U.name,tracks:a}),e.jsx(G,{albums:c})]})}const pt=g("/track/$trackId")({component:ft});function ft(){return e.jsx("div",{children:e.jsx(xt,{})})}const gt=g("/playlist/playlistId")({component:yt});function yt(){return e.jsx("div",{children:'Hello "/playlist/playlistId"!'})}const jt=g("/artist/$id")({component:wt});function wt(){return e.jsx("div",{children:'Hello "/artist/$id"!'})}function kt({artistInfo:s}){var o;const{name:t,image:r,followers:a,searchQuery:n}=s||{},l=B(),c=()=>{l.navigate({to:"/search",replace:!0,state:{searchQuery:n}})};return e.jsxs("div",{className:"m-4",children:[e.jsx(H,{className:"m-4 w-8 h-8 cursor-pointer",onClick:c}),e.jsx("div",{className:"flex flex-col items-center justify-center",children:e.jsx("img",{width:"200",height:"200",className:"rounded-full w-[200px] h-[200px] object-cover flex items-center justify-center shrink-0",src:r,alt:""})}),e.jsxs("div",{className:"flex flex-col items-center justify-center pt-4",children:[e.jsx("h1",{className:"text-2xl font-bold items-start",children:((o=t==null?void 0:t.charAt(0))==null?void 0:o.toUpperCase())+(t==null?void 0:t.slice(1))}),e.jsxs("p",{children:[" ",new Intl.NumberFormat().format(a==null?void 0:a.total)," - фоловеров"]})]})]})}function Nt(){const s=E(),t=je({from:"/artist/$artistId",select:i=>i.artistId}),{data:r,isLoading:a,error:n}=j({queryKey:["artist",t],queryFn:()=>F(t)}),{data:l,isLoading:c,error:o}=j({queryKey:["tracks",t],queryFn:()=>Q(t)});return a||c?e.jsx("div",{className:"mx-auto my-auto flex justify-center items-center",children:"Loading..."}):n||o?(console.log("artistId passed to useQuery:",t),e.jsxs("div",{children:["Error: ",(n==null?void 0:n.message)||(o==null?void 0:o.message)]})):e.jsxs("div",{children:[e.jsx(kt,{artistInfo:s.state}),e.jsx(W,{tracks:l}),e.jsx(G,{albums:r})]})}const bt=g("/artist/$artistId")({component:Nt}),vt=g("/album/$albumId")({component:It});function It(){return e.jsx("div",{children:'Hello "/album/$albumId"!'})}const Pt=Be.update({id:"/search",path:"/search",getParentRoute:()=>y}),X=Ze.update({id:"/playlist",path:"/playlist",getParentRoute:()=>y}),St=Ge.update({id:"/download",path:"/download",getParentRoute:()=>y}),Ct=Xe.update({id:"/callback",path:"/callback",getParentRoute:()=>y}),$t=it.update({id:"/",path:"/",getParentRoute:()=>y}),Rt=pt.update({id:"/track/$trackId",path:"/track/$trackId",getParentRoute:()=>y}),Tt=gt.update({id:"/playlistId",path:"/playlistId",getParentRoute:()=>X}),At=jt.update({id:"/artist/$id",path:"/artist/$id",getParentRoute:()=>y}),_t=bt.update({id:"/artist/$artistId",path:"/artist/$artistId",getParentRoute:()=>y}),Et=vt.update({id:"/album/$albumId",path:"/album/$albumId",getParentRoute:()=>y}),Ft={PlaylistPlaylistIdRoute:Tt},Lt=X._addFileChildren(Ft),Mt={IndexRoute:$t,CallbackRoute:Ct,DownloadRoute:St,PlaylistRoute:Lt,SearchRoute:Pt,AlbumAlbumIdRoute:Et,ArtistArtistIdRoute:_t,ArtistIdRoute:At,TrackTrackIdRoute:Rt},Ut=y._addFileChildren(Mt)._addFileTypes(),qt=Ce({reducer:{player:mt,track:at}}),Ot=Pe(),Bt=we({routeTree:Ut,history:Ot}),Ht=new Se({defaultOptions:{queries:{staleTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}}}),O=document.getElementById("root");O.innerHTML||ke.createRoot(O).render(e.jsx(Ne,{client:Ht,children:e.jsx(be,{store:qt,children:e.jsx(K,{children:e.jsx(ve,{router:Bt})})})}));
